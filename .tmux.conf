##########################################
# Bindings
##########################################

# Set the prefix to `ctrl + a` instead of `ctrl + s`
unbind C-b
set -g prefix C-s
bind C-s send-prefix

# don't suspend-client
unbind-key C-z

# split panes using | and -
bind | split-window -h -c "#{pane_current_path}"
bind - split-window -v -c "#{pane_current_path}"
unbind '"'
unbind %

# Bind D | U to resize the window to be 8 lines smaller | larger
bind D resize-pane -D 5
bind U resize-pane -U 5

##########################################
# VIM bindings
##########################################
bind h select-pane -L
bind j select-pane -D
bind k select-pane -U
bind l select-pane -R

# Smart pane switching with awareness of Vim splits.
# See: https://github.com/christoomey/vim-tmux-navigator
is_vim="ps -o state= -o comm= -t '#{pane_tty}' | grep -iqE '^[^TXZ ]+ +(\\S+\\/)?g?(view|n?vim?x?)(diff)?$'"
bind-key -n C-h if-shell "$is_vim" "send-keys C-h"  "select-pane -L"
bind-key -n C-j if-shell "$is_vim" "send-keys C-j"  "select-pane -D"
bind-key -n C-k if-shell "$is_vim" "send-keys C-k"  "select-pane -U"
bind-key -n C-l if-shell "$is_vim" "send-keys C-l"  "select-pane -R"
bind-key -n C-\ if-shell "$is_vim" "send-keys C-\\" "select-pane -l"

#allow vi keybindings in tmux command mode :
set-option -g status-keys vi
set-option -sg escape-time 10

# Use vim keybindings in copy mode
setw -g mode-keys vi
bind-key -T copy-mode-vi v send-keys -X begin-selection
bind-key -T copy-mode-vi r send-keys -X rectangle-toggle
bind-key -T copy-mode-vi y send-keys -X copy-pipe-and-cancel "xsel -i -p && xsel -o -p | xsel -i -b"
bind-key p run "xsel -o | tmux load-buffer - ; tmux paste-buffer"

unbind p
bind p paste-buffer
bind [ copy-mode

##########################################
# Panes settings
##########################################
bind F source-file ~/.tmux/four-panes
bind G source-file ~/.tmux/eight-panes
bind H source-file ~/.tmux/sixteen-panes
bind T source-file ~/.tmux/config-files
bind x kill-pane

##########################################
# Prompt settings
##########################################
# Bind settings for buffer
bind Space choose-buffer

bind-key : command-prompt
bind-key L clear-history\; display-message "History was cleaned."

# Easy config reload
bind-key R source-file ~/.tmux.conf \; display-message "tmux.conf reloaded."

# Quicker session kill
bind X confirm-before kill-session

# Use m to toggle mouse mode
set -g mouse on
unbind m
bind m setw mouse

set -g default-shell $SHELL

# start window numbers at 1 to match keyboard order with tmux window order
set -g base-index 1
set-window-option -g pane-base-index 1

set -g history-limit 10000

#automatically renumber windows
set-option -g renumber-windows on

#display messages for 2 seconds
set-option -g display-time 2000

#display panes for 3 seconds
set-option -g display-panes-time 3000

# Refresh status line every 5 seconds
set -g status-interval 5

##########################################
# Design changes
##########################################
# Center window list for clarity
set -g status-justify centre

# Set border's styles(v2.9)
set -g pane-border-style bg=colour235
set -g pane-border-style fg=colour238
set -g pane-active-border-style bg=colour237
set -g pane-active-border-style fg=colour1

# colors
#colour0 (black)
#colour1 (red)
#colour2 (green)
#colour3 (yellow)
#colour4 (blue)
#colour7 (white)
#colour5 colour6 colour7 colour8 colour9 colour10 colour11 colour12 colour13 colour14 colour15 colour16 colour17

#D ()
#F ()
#H (hostname)
#I (window index)
#P()
#S (session index)
#T (pane title)
#W (currnet task like vim if editing a file in vim or zsh if running zsh)

set -g default-terminal "screen-256color"
# Enable RGB colour if running in xterm(1)
set-option -sa terminal-overrides ",xterm*:Tc"

set -g status-fg colour231
set -g status-bg colour234

# length of tmux status line
set -g status-left-length 50
set -g status-right-length 150

# Set the background color
set -g status-bg colour8

# Set the left and right status
set -g status-left '#[bg=colour7]#[fg=colour0]#{?client_prefix,#[bg=colour2],} ‚ùê #S #[bg=colour8]#[fg=colour7]#{?client_prefix,#[fg=colour2],}ÓÇ∞#{?window_zoomed_flag, üîç ,}#[fg=colour1]  ‚ô• #(~/.config/shared/dotfiles/tmux_scripts/battery.sh) #[fg=colour3] ÓÇ† #(cd #{pane_current_path}; git rev-parse --abbrev-ref HEAD)'
set -g status-right '#[bg=colour60]#[fg=colour60]#(tmux-mem-cpu-load --colors --interval 5)#[bg=colour4]#[fg=colour0] #(~/.config/shared/dotfiles/tmux_scripts/music.sh) #[bg=colour4]#[fg=colour7]ÓÇ≤#[bg=colour7]#[fg=colour0]#{?client_prefix,#[bg=colour2],} %b %d %H:%M #{?client_prefix,#[bg=colour2],}'
# set -g status-right 'Batt: #{battery_icon} #{battery_percentage} | %a %Y-%m-%d %H:%M '

# Customize how windows are displayed in the status line
set -g window-status-current-format "#[fg=colour8]#[bg=colour4]ÓÇ∞#[fg=colour7]#[bg=colour4] #I* ÓÇ±#[fg=colour7] #W #[fg=colour4]#[bg=colour8]ÓÇ∞"
set -g window-status-format "#[fg=colour244]#[bg=colour8]#I-#[fg=colour240] ÓÇ± #W"

##########################################
# Plugin Manager
##########################################
# Set Plufins
set -g @plugin 'tmux-plugins/tpm'
set -g @plugin 'tmux-plugins/tmux-sensible'
set -g @plugin 'tmux-plugins/tmux-resurrect'
set -g @plugin 'tmux-plugins/tmpux-prefix-highlight'
set -g @plugin 'tmux-plugins/tmux-continuum'
set -g @plugin 'tmux-plugins/tmux-battery'
set -g @plugin 'thewtex/tmux-mem-cpu-load'

run '~/.tmux/plugins/tpm/tpm'
